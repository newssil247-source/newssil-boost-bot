{
  "name": "NEWSSIL – Cross-Post Orchestrator v42b (Retry + RateLimit)",
  "description": "Receives payload from the Newssil bot, enforces per-platform rate limits, retries transient failures, and posts to X/FB/IG/TikTok. IG/TikTok only if allowIGTikTok=true.",
  "metadata": {
    "created_at": 1761559883
  },
  "flow": {
    "root": {
      "modules": [
        {
          "id": 1,
          "name": "Incoming – Bot Webhook",
          "type": "hook",
          "app": "webhooks",
          "action": "customWebhook",
          "parameters": {
            "hookName": "newssil_crosspost_v42b",
            "payload": true
          }
        },
        {
          "id": 2,
          "name": "Compose caption + footer",
          "type": "function",
          "app": "tools",
          "action": "textAggregator",
          "parameters": {
            "separator": "\n\n",
            "items": [
              {
                "type": "mapping",
                "value": "{{1.body.text || 1.body.caption}}"
              },
              {
                "type": "mapping",
                "value": ""
              },
              {
                "type": "text",
                "value": "✦ X | Instagram | TikTok | Telegram"
              }
            ]
          }
        },
        {
          "id": 3,
          "name": "Rate-limit guard (sleep 2s)",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 2
          }
        },
        {
          "id": 4,
          "name": "Router",
          "type": "router"
        },
        {
          "id": 10,
          "name": "X – Try #1",
          "type": "module",
          "app": "twitter",
          "action": "createTweetWithMedia",
          "parameters": {
            "text": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 11,
          "name": "If X fails → wait 5s",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 5
          }
        },
        {
          "id": 12,
          "name": "X – Try #2",
          "type": "module",
          "app": "twitter",
          "action": "createTweetWithMedia",
          "parameters": {
            "text": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 13,
          "name": "If X fails → wait 10s",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 10
          }
        },
        {
          "id": 14,
          "name": "X – Try #3",
          "type": "module",
          "app": "twitter",
          "action": "createTweetWithMedia",
          "parameters": {
            "text": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 15,
          "type": "link",
          "from": 4,
          "to": 10
        },
        {
          "id": 20,
          "name": "Facebook Page – Try #1",
          "type": "module",
          "app": "facebookPages",
          "action": "createPostFromUrl",
          "parameters": {
            "message": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 21,
          "name": "If FB fails → wait 5s",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 5
          }
        },
        {
          "id": 22,
          "name": "Facebook Page – Try #2",
          "type": "module",
          "app": "facebookPages",
          "action": "createPostFromUrl",
          "parameters": {
            "message": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 23,
          "name": "If FB fails → wait 10s",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 10
          }
        },
        {
          "id": 24,
          "name": "Facebook Page – Try #3",
          "type": "module",
          "app": "facebookPages",
          "action": "createPostFromUrl",
          "parameters": {
            "message": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 25,
          "type": "link",
          "from": 4,
          "to": 20
        },
        {
          "id": 30,
          "name": "IG allowed?",
          "type": "filter",
          "condition": "{{1.body.allowIGTikTok}}"
        },
        {
          "id": 31,
          "name": "IG – Create container #1",
          "type": "module",
          "app": "instagramForBusiness",
          "action": "createMediaContainerFromUrl",
          "parameters": {
            "caption": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 32,
          "name": "IG – Publish #1",
          "type": "module",
          "app": "instagramForBusiness",
          "action": "publishContainer",
          "parameters": {
            "containerId": "{{31.id}}"
          }
        },
        {
          "id": 33,
          "name": "If IG fails → wait 5s",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 5
          }
        },
        {
          "id": 34,
          "name": "IG – Create container #2",
          "type": "module",
          "app": "instagramForBusiness",
          "action": "createMediaContainerFromUrl",
          "parameters": {
            "caption": "{{2.output}}",
            "mediaUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 35,
          "name": "IG – Publish #2",
          "type": "module",
          "app": "instagramForBusiness",
          "action": "publishContainer",
          "parameters": {
            "containerId": "{{34.id}}"
          }
        },
        {
          "id": 36,
          "type": "link",
          "from": 4,
          "to": 30
        },
        {
          "id": 40,
          "name": "TikTok allowed?",
          "type": "filter",
          "condition": "{{1.body.allowIGTikTok}}"
        },
        {
          "id": 41,
          "name": "TikTok – Upload #1",
          "type": "module",
          "app": "tiktok",
          "action": "uploadVideoByUrl",
          "parameters": {
            "caption": "{{2.output}}",
            "videoUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 42,
          "name": "If TT fails → wait 5s",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 5
          }
        },
        {
          "id": 43,
          "name": "TikTok – Upload #2",
          "type": "module",
          "app": "tiktok",
          "action": "uploadVideoByUrl",
          "parameters": {
            "caption": "{{2.output}}",
            "videoUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 44,
          "name": "If TT fails → wait 10s",
          "type": "module",
          "app": "tools",
          "action": "sleep",
          "parameters": {
            "duration": 10
          }
        },
        {
          "id": 45,
          "name": "TikTok – Upload #3",
          "type": "module",
          "app": "tiktok",
          "action": "uploadVideoByUrl",
          "parameters": {
            "caption": "{{2.output}}",
            "videoUrl": "{{1.body.assets.processed_url}}"
          }
        },
        {
          "id": 46,
          "type": "link",
          "from": 4,
          "to": 40
        }
      ],
      "links": [
        {
          "from": 1,
          "to": 2
        },
        {
          "from": 2,
          "to": 3
        },
        {
          "from": 3,
          "to": 4
        },
        {
          "from": 10,
          "to": 11,
          "onError": true
        },
        {
          "from": 11,
          "to": 12
        },
        {
          "from": 12,
          "to": 13,
          "onError": true
        },
        {
          "from": 13,
          "to": 14
        },
        {
          "from": 20,
          "to": 21,
          "onError": true
        },
        {
          "from": 21,
          "to": 22
        },
        {
          "from": 22,
          "to": 23,
          "onError": true
        },
        {
          "from": 23,
          "to": 24
        },
        {
          "from": 31,
          "to": 33,
          "onError": true
        },
        {
          "from": 33,
          "to": 34
        },
        {
          "from": 34,
          "to": 35
        },
        {
          "from": 41,
          "to": 42,
          "onError": true
        },
        {
          "from": 42,
          "to": 43
        },
        {
          "from": 43,
          "to": 44,
          "onError": true
        },
        {
          "from": 44,
          "to": 45
        }
      ]
    }
  }
}